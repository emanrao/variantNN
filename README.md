# variantNN

## Single Nucleotide Polymorphism (SNP) detection for Single Molecule DNA Sequencing </br>
Identify and classify genomic variants from single molecule DNA sequencing data 
</br>
### <b> Modules: </b> </br>
<b>varient.py</b> </br>
Main script starting from raw datasets</br>
 - CHROM21_v.3.3.2_highconf_noinconsistent.bed </br>
 - CHROM22_v.3.3.2_highconf_noinconsistent.bed </br>
 - variants_chr21 </br>
 - variants_chr21 </br>
 - aln_tensor_chr21 </br>
 - aln_tensor_chr21 </br>
</br>
<b>demo.py</b> </br>
Simplified script using preprocessed datasets</br>
 - Xtrain.txt </br>
 - Ytrain.txt </br>
 - Xtest.txt </br>
 - Ytest.txt 
</br></br>

### <b> Datasets: </b> </br>
Located at:  https://variantnn-demo.s3.amazonaws.com/</br>
or in /data folder (with some files compressed)

</br></br>
Dataset from aggregated alignment BAM file:</br>
 NA12878 PacBio read dataset generated by WUSTL (https://www.ncbi.nlm.nih.gov//bioproject/PRJNA323611)
</br></br>
Alignment information stored in 3- 15x4 matrices (15 nt, 4 bases coded as one-hot-coding)</br>
 - baseline encoded refernce sequence and total counts </br>
 - difference between reference counts and seq counts </br>
 - difference between reference counts and insertion counts
 
</br></br>

Align to known variants: </br>
GIAB project (ftp://ftp-trace.ncbi.nlm.nih.gov:/giab/ftp/release/NA12878_HG001/NISTv3.3.2/GRCh38) </br>
List of 15nt sequences containing variant candidates at center postion </br>
Train using the high confidence calls on chromosome 21 and test on chromosome 22
</br></br>

### <b>Model:</b> </br>
Two convolution + maxpool layers </br>
Three fully connected layers. </br>
The output layer contains two group of outputs, each a 4x array. </br>
 - Base Identity in [A C G T] </br>
 - Variant type [het, hom, non-var, other-var] </br>
</br></br>

Based on VariantNet: </br>
 - https://github.com/pb-jchin/VariantNET</br>
 - https://towardsdatascience.com/simple-convolution-neural-network-for-genomic-variant-calling-with-tensorflow-c085dbc2026f
</br></br>
Modified to run on Clusterone (distributed task with Tensorboard monitoring)



-emanrao
